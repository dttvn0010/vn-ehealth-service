      <component>
        <section>
          <templateId root="2.16.840.1.113883.3.6000.4.3"/>
          
          <code code="29308-4" 
          		codeSystem="2.16.840.1.113883.6.1" 
          		codeSystemName="LOINC" 
          		displayName="Diagnosis"
          		/>
          		
          <title>CHẨN ĐOÁN</title>
          <text>
          	<table>
          		<tbody>
	          		<tr>
	          			<td>Nơi chuyển đến:</td>
	          			<td>
	         			#set($dm = $!hsba.chanDoan.dmMaBenhChanDoanNoiDen)
	          			#if(! $utils.isBlank($!dm.ma ))
	          				$!dm.ten ( $!dm.ma )
	          			#else
	          				$!hsba.chanDoan.moTaChanDoanNoiDen
	          			#end
	          			</td>
	          		</tr>
	          		<tr>
	          			<td>KKB, Cấp cứu:</td>
	          			<td>
	          			#set($dm = $!hsba.chanDoan.dmMaBenhChanDoanKkb)
	          			#if(! $utils.isBlank($!dm.ma ))
	          				$!dm.ten ( $!dm.ma )
	          			#else
	          				$!hsba.chanDoan.moTaChanDoanKkb
	          			#end
	          			</td>
	          		</tr>
	          		<tr>
	          			<td>Bệnh chính:</td>
	          			<td>
	          			#set($dm = $!hsba.chanDoan.dmMaBenhChanDoanDieuTriChinh)
	          			#if(! $utils.isBlank($!dm.ma ))
	          				$!dm.ten ( $!dm.ma )
	          			#else
	          				$!hsba.chanDoan.moTaChanDoanDieuTriChinh
	          			#end
	          			</td>
	          		</tr>
	          		<tr>
	          			<td>Bệnh kèm theo:</td>
	          			<td>
	          			#set($dmList = $!hsba.chanDoan.dsDmMaBenhChanDoanDieuTriKemTheo)
						#if($!dmList.size() > 0)
						  	#foreach( $dm in $dmList ) $!dm.ten ( $dm.ma ) , #end
						#else
							$!hsba.chanDoan.moTaChanDoanDieuTriKemTheo
						#end
	          			</td>
	          		</tr>
	          		<tr>
	          			<td>Phân biệt:</td>
	          			<td>
	          			#set($dm = $!hsba.chanDoan.dmMaBenhChanDoanDieuTriPhanBiet)
	          			#if(! $utils.isBlank($!dm.ma ))
	          				$!dm.ten ( $!dm.ma )
	          			#else
	          				$!hsba.chanDoan.moTaChanDoanDieuTriPhanBiet
	          			#end
	          			</td>
	          		</tr>
	          		<tr>
	          			<td>Bệnh chính ra viện:</td>
	          			<td>
	          			#set($dm = $!hsba.chanDoan.dmMaBenhChanDoanRaVienChinh)
	          			#if(! $utils.isBlank($!dm.ma ))
	          				$!dm.ten ( $!dm.ma )
	          			#else
	          				$!hsba.chanDoan.moTaChanDoanRaVienChinh
	          			#end
	          			</td>
	          		</tr>
	          		<tr>
	          			<td>Bệnh kèm theo ra viện:</td>
	          			<td>
	          			#set($dmList = $!hsba.chanDoan.dsDmMaBenhChanDoanRaVienKemTheo)
						#if($!dmList.size() > 0)
						  	#foreach( $dm in $dmList ) $!dm.ten ( $dm.ma ) , #end
						#else
							$!hsba.chanDoan.moTaChanDoanRaVienKemTheo
						#end
	          			</td>
	          		</tr>
	          		<tr>
	          			<td>Nguyên nhân ra viện:</td>
	          			<td>
	          			#set($dm = $!hsba.chanDoan.dmMaBenhChanDoanRaVienNguyenNhan)
	          			#if(! $utils.isBlank($!dm.ma ))
	          				$!dm.ten ( $!dm.ma )
	          			#else
	          				$!hsba.chanDoan.moTaChanDoanRaVienNguyenNhan
	          			#end
	          			</td>
	          		</tr>
	          		<tr>
	          			<td>Trước phẫu thuật:</td>
	          			<td>
	          			#set($dm = $!hsba.chanDoan.dmMaBenhChanDoanTruocPttt)
	          			#if(! $utils.isBlank($!dm.ma ))
	          				$!dm.ten ( $!dm.ma )
	          			#else
	          				$!hsba.chanDoan.moTaChanDoanTruocPttt
	          			#end
	          			</td>
	          		</tr>
	          		<tr>
	          			<td>Sau phẫu thuật:</td>
	          			<td>
	          			#set($dm = $!hsba.chanDoan.dmMaBenhChanDoanSauPttt)
	          			#if(! $utils.isBlank($!dm.ma ))
	          				$!dm.ten ( $!dm.ma )
	          			#else
	          				$!hsba.chanDoan.moTaChanDoanSauPttt
	          			#end
	          			</td>
	          		</tr>
	          	</tbody>
          	</table>
          </text>
          
          #if(!$utils.isBlank($!hsba.chanDoan.dmMaBenhChanDoanNoiDen.ma) || !$utils.isBlank($!hsba.chanDoan.moTaChanDoanNoiDen))
          <entry>
            <observation classCode="OBS" moodCode="EVN">
              <templateId root="2.16.840.1.113883.3.6000.5.1.1"/>
              
              <code code="44833-2" 
                    codeSystem="2.16.840.1.113883.6.1" 
                    codeSystemName="LOINC" 
                    displayName="Preliminary diagnosis"
                    />
                    
              <entryRelationship typeCode="COMP">
                <observation classCode="OBS" moodCode="EVN">
                  <templateId root="2.16.840.1.113883.3.6000.5.1.0.1"/>
                  <id root="$utils.randomUUID()"/>
                  
                  <code code="282291009" 
                  		codeSystem="2.16.840.1.113883.6.96" 
                  		codeSystemName="SNOMED CT" 
                  		displayName="Diagnosis"
                  		/>
                  		
                  $!utils.createText($!hsba.chanDoan.moTaChanDoanNoiDen)
                  
                  #set($dm=$!hsba.chanDoan.dmMaBenhChanDoanNoiDen)
                  <value xsi:type="CD" 
                 		 code="$!dm.ma"
                 		 codeSystem="2.16.840.1.113883.3.6000.6.3"
                 		 displayName="$!dm.ten"/>
                 		                   		
                </observation>
              </entryRelationship>
            </observation>
          </entry>
          #end
          
          #if(!$utils.isBlank($!hsba.chanDoan.dmMaBenhChanDoanKkb.ma) || !$utils.isBlank($!hsba.chanDoan.dmMaBenhChanDoanKkb))
          <entry>
            <observation classCode="OBS" moodCode="EVN">
              <templateId root="2.16.840.1.113883.3.6000.5.1.2"/>
              
              <code code="8646-2" 
                    codeSystem="2.16.840.1.113883.6.1" 
                    codeSystemName="LOINC" 
                    displayName="Admission diagnosis"/>
                    
              <entryRelationship typeCode="COMP">
                <observation classCode="OBS" moodCode="EVN">
                  <templateId root="2.16.840.1.113883.3.6000.5.1.0.1"/>
                  <id root="$utils.randomUUID()"/>
                  
                  <code code="282291009" 
                  		codeSystem="2.16.840.1.113883.6.96" 
                  		codeSystemName="SNOMED CT" 
                  		displayName="Diagnosis"/>
                  		
                  $!utils.createText($!hsba.chanDoan.moTaChanDoanKkb)
                  
                  #set($dm=$!hsba.chanDoan.dmMaBenhChanDoanKkb)
                  <value xsi:type="CD" 
                 		 code="$!dm.ma"
                 		 codeSystem="2.16.840.1.113883.3.6000.6.3"
                 		 displayName="$!dm.ten"/>
                 		 
                </observation>
              </entryRelationship>
            </observation>
          </entry>
          #end
          
          #if(!$utils.isBlank($!hsba.chanDoan.dmMaBenhChanDoanRaVienChinh.ma) || !$utils.isBlank($!hsba.chanDoan.moTaChanDoanRaVienChinh))
          <entry>
            <observation classCode="OBS" moodCode="EVN">
              <templateId root="2.16.840.1.113883.3.6000.5.1.4"/>
              
              <code code="8651-2" 
              		codeSystem="2.16.840.1.113883.6.1" 
              		codeSystemName="LOINC" 
              		displayName="Discharge diagnosis"
              		/>
              
              <entryRelationship typeCode="COMP">
                <observation classCode="OBS" moodCode="EVN">
                  <templateId root="2.16.840.1.113883.3.6000.5.1.0.1"/>
                  <id root="$utils.randomUUID()"/>
                  
                  <code code="282291009" 
                  		codeSystem="2.16.840.1.113883.6.96" 
                  		codeSystemName="SNOMED CT" 
                  		displayName="Diagnosis"
                  		/>
                  
                  $!utils.createText($!hsba.chanDoan.moTaChanDoanRaVienChinh)
                  
                  #set($dm=$!hsba.chanDoan.dmMaBenhChanDoanRaVienChinh)
                  <value xsi:type="CD" 
                 		 code="$!dm.ma"
                 		 codeSystem="2.16.840.1.113883.3.6000.6.3"
                 		 displayName="$!dm.ten"/>
                  
                </observation>
              </entryRelationship>              
            </observation>
          </entry>
          #end
       
          <entry>
            <observation classCode="OBS" moodCode="EVN">
              <templateId root="2.16.840.1.113883.3.6000.5.1.5"/>
              
              <code code="8720-5" 
              		codeSystem="2.16.840.1.113883.6.1" 
              		codeSystemName="LOINC" 
              		displayName="Preoperative diagnosis"
              		/>
              
              <entryRelationship typeCode="COMP">
                <observation classCode="OBS" moodCode="EVN">
                  <templateId root="2.16.840.1.113883.3.6000.5.1.0.1"/>
                  <id root="$utils.randomUUID()"/>
                  <code code="282291009" 
                  		codeSystem="2.16.840.1.113883.6.96" 
                  		codeSystemName="SNOMED CT" 
                  		displayName="Diagnosis"
                  		/>
                 
                  #set($dm = $hsba.chanDoan.dmMaBenhChanDoanTruocPttt)
                  <value xsi:type="CD" 
                 		 code="$!dm.ma"
                 		 codeSystem="2.16.840.1.113883.3.6000.6.3"
                 		 displayName="$!dm.ten"/>
                 		 
                  $!utils.createText($!hsba.chanDoan.moTaChanDoanTruocPttt)
                </observation>
              </entryRelationship>
            </observation>
          </entry>
          
          <entry>
            <observation classCode="OBS" moodCode="EVN">
              <templateId root="2.16.840.1.113883.3.6000.5.1.6"/>
              
              <code code="8719-7" 
              		codeSystem="2.16.840.1.113883.6.1" 
              		codeSystemName="LOINC" 
              		displayName="Postoperative diagnosis"
              		/>
              
              <entryRelationship typeCode="COMP">
                <observation classCode="OBS" moodCode="EVN">
                  <templateId root="2.16.840.1.113883.3.6000.5.1.0.1"/>
                  <id root="$utils.randomUUID()"/>
                  
                  
                  <code code="282291009" 
                  		codeSystem="2.16.840.1.113883.6.96" 
                  		codeSystemName="SNOMED CT" 
                  		displayName="Diagnosis"/>
                  
                  $!utils.createText($!hsba.chanDoan.moTaChanDoanSauPttt)
                  
                  #set($dm=$!hsba.chanDoan.dmMaBenhChanDoanSauPttt)
                  <value xsi:type="CD" 
                 		 code="$!dm.ma"
                 		 codeSystem="2.16.840.1.113883.3.6000.6.3"
                 		 displayName="$!dm.ten"/>
                 		                  		
                </observation>
              </entryRelationship>
            </observation>
          </entry>
          
        </section>
      </component>